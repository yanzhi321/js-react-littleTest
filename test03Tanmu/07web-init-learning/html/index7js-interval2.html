<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="keywords" content="HTML, CSS, XML" />
	<!-- 描述 -->
	<meta name="description" content="Free Web tutorials on HTML, CSS, JavaScript 不超过150个字符">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" />
	<!-- 以下代码告诉IE浏览器，IE8/9及以后的版本都会以最高版本IE来渲染页面。   -->
    <!-- GCF(Google Chrome Frame谷歌内嵌浏览器框架GCF)，则使用GCF来渲染页面，如果没有安装，则使用最高版本的IE内核进行渲染 -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<title>js-interval2</title>
	<link rel="shortcut icon" href="images/favicon.ico">
	<link rel="stylesheet" type="text/css" href="normalize/normalize.css">
	<link rel="stylesheet" type="text/css" href="iconfont/iconfont.css">
</head>
<body>
	<div class="container">
		<div id="myDiv">
		    <label for="set"><input id="set" value="0"></label>
		    <button id="btn">开始</button>
		    <button id="reset">重置</button>    
		</div>
	</div>

	<script>
		var timer;
		var con = 'off';
		//ori表示初始的系统时间
		var ori;
		//dis表示当前运行时的秒数(动态)
		var dis = 0;
		//last储存暂停时的秒数(静态)
		var last = 0;
		reset.onclick = function(){
		    history.go();
		}
		btn.onclick = function(){
		    if(con === 'off'){
		        set.setAttribute('disabled','disabled');
		        con = 'on';
		        btn.innerHTML = '暂停';
		        //保留已经走过的秒数的系统时间
		        ori = (new Date()).getTime() - last; 
		        timer = requestAnimationFrame(function fn(){
		            dis = (new Date()).getTime() - ori;
		            cancelAnimationFrame(timer);
		            timer = requestAnimationFrame(fn);
		            var minute = Math.floor(dis/1000/60);
		            var second = Math.floor(dis/1000);
		            var ms = Math.floor(dis%1000);
		            set.value = minute + ' : ' + second + ' . ' + ms; 
		        });
		    }else{
		        cancelAnimationFrame(timer);
		        btn.innerHTML = '开始';    
		        con = 'off';
		        last = dis;
		    }
		}      
	</script>
</body>
</html>